---
layout: post
tag: [岐大祭2018, Unity, Mobile]
---

この記事は、岐大祭に向けてアドベントカレンダー的な記事を書く企画の 6 日目です。

私は音声認識を使ってキャラクターを動かすゲームを作ったので、主に音声認識について書いていこうと思います。
多分、他の記事よりかは初心者向けかと思われます。

## ゲームの概要

このゲームは Unity で制作した、 Android 用のゲームです。
キリンのキャラクター 「ジラ太朗」 に音声で命令してゴールまで導くゲームです。
例えば 「すすめ」 と言ったら進むし、 「ジャンプ」 と言ったらジャンプします。
ムーンサルトさせたり、マシンガンを放ったりすることもできます。
いろいろとはっちゃけてます。

## 音声認識について

音声認識の方法について書いていこうと思います。
まず、一般的な Android アプリ開発では API を使うことで、簡単に音声認識ができます。
代表的な API として [Speech Recognizer](https://developer.android.com/reference/android/speech/SpeechRecognizer) というものがあり、このゲームでもこれを使っています。

しかし、 Unity ではこれだけで音声認識はできません。
一般的な Android アプリ開発が、 Java で行われるのに対し、 Unity は C# であるためです。
そこで Unity には [ネイティブプラグイン](https://docs.unity3d.com/ja/current/Manual/Plugins.html) という機能があります。
ネイティブプラグインを使うと、 システムコールやサードパティのコードライブラリなどといった、元々 Unity で使用できない機能にアクセスできます。
これを利用して Speech Recognizer を Unity に適用します。
以下はネイティブプラグインの利用の流れの一例です。

1. Eclipse, Android Studio などで Java コードを書く
2. aar ファイル, xml ファイルを作成
3. Unity に aar, xml ファイルを置く
4. C# コードを書いてプラグインを適用

……なんでこんな大雑把なのかといいますと、実際はこんなことやってないんです。
というのもすでにこのようなことをやっている方がいまして、プラグインのサンプルがネットに公開されていたためです。
これをお借りして自分なりにアレンジして使用しました。
お借りしたものは [こちら](http://fantom1x.blog130.fc2.com/blog-entry-273.html) で公開されています。
そのため私から音声認識の実装方法に関して、これ以上言えることはありません。

ただ、 Unity は人口が多く、自分がやろうと思っていることをすでにやっている人がいて、やり方やサンプルが公開されているということはよくあることだと思います。
だからまず、何か公開されているものを探すのも１つの手だと思います。
